{"version":3,"sources":["../../src/route/weather.js"],"names":[],"mappings":";;;;;;AAAA;;;;AACA;;kBAEe,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAO,GAAP,CAAW,uBAAX;AAAA,iCAAoC,WAAM,GAAN,EAAa;AAC/C,UAAI,IAAJ,GAAW,CAAC,MAAM,2BACf,OADe,CACP,EAAE,MAAM,IAAI,MAAJ,CAAW,MAAnB,EADO,EAEf,QAFe,CAEN,eAFM,CAAP,EAGR,aAHH;AAID,KALD;;AAAA;AAAA;AAAA;AAAA;AAMA,SAAO,GAAP,CAAW,0BAAX;AAAA,kCAAuC,WAAM,GAAN,EAAa;AAClD,UAAI,IAAJ,GAAW,CAAC,MAAM,2BACf,IADe,CACV,EAAE,MAAM,EAAE,KAAK,IAAI,MAAJ,CAAW,OAAX,CAAmB,KAAnB,CAAyB,GAAzB,CAAP,EAAR,EADU,EAEf,QAFe,CAEN,eAFM,CAAP,EAGR,GAHQ,CAGJ;AAAA,eAAuB,oBAAoB,aAA3C;AAAA,OAHI,CAAX;AAID,KALD;;AAAA;AAAA;AAAA;AAAA;AAMD,C","file":"weather.js","sourcesContent":["import { LatestWeatherReport } from '../model';\n// import fetchWeather from '../lib/fetch-weather';\n\nexport default router => {\n  // router.get('/weather/fetch/city/:cityId', async ctx => {\n  //   try {\n  //     const weather = await fetchWeather(ctx.params.cityId);\n  //     ctx.body = weather;\n  //   } catch (err) {\n  //     ctx.throw(constants.thirdParty);\n  //   }\n  // });\n  // router.get('/weather/fetch/cities/:cityIds', async ctx => {\n  //   try {\n  //     const weather = await fetchWeather(ctx.params.cityIds);\n  //     ctx.body = weather;\n  //   } catch (err) {\n  //     ctx.throw(constants.thirdParty);\n  //   }\n  // });\n  router.get('/weather/city/:cityId', async ctx => {\n    ctx.body = (await LatestWeatherReport\n      .findOne({ city: ctx.params.cityId })\n      .populate('weatherReport'))\n      .weatherReport;\n  });\n  router.get('/weather/cities/:cityIds', async ctx => {\n    ctx.body = (await LatestWeatherReport\n      .find({ city: { $in: ctx.params.cityIds.split(',') } })\n      .populate('weatherReport'))\n      .map(latestWeatherReport => latestWeatherReport.weatherReport);\n  });\n};\n"]}