{"version":3,"sources":["../../src/model/weather-criteria.js"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEA,MAAM,wBAAwB,qBAAW;AACvC,QAAM;AACJ,UAAM,iBAAO,KAAP,CAAa,QADf;AAEJ,SAAK,MAFD;AAGJ,cAAU,IAHN;AAIJ,WAAO;AAJH,GADiC;AAOvC,QAAM;AACJ,UAAM,MADF;AAEJ,SAAK,MAFD;AAGJ,cAAU,IAHN;AAIJ,WAAO;AAJH,GAPiC;AAavC,eAAa;AACX,UAAM,MADK;AAEX,cAAU;AAFC,GAb0B;AAiBvC,aAAW;AACT,UAAM,MADG;AAET,UAAM,CAAC,SAAD,EAAY,MAAZ,CAFG;AAGT,aAAS,SAHA;AAIT,cAAU;AAJD,GAjB4B;AAuBvC,eAAa;AACX,UAAM;AADK,GAvB0B;AA0BvC,mBAAiB;AACf,UAAM;AADS;AA1BsB,CAAX,EA6B3B;AACD;AACA,cAAY;AAFX,CA7B2B,CAA9B;;AAkCA,sBAAsB,OAAtB,CAA8B,0BAA9B,GAA2D,UAAU,WAAV,EAAuB;AAChF,UAAQ,KAAK,SAAb;AACE,SAAK,SAAL;AACE,aAAO,eAAe,KAAK,WAA3B;AACF,SAAK,MAAL;AACE,aAAO,eAAe,KAAK,WAA3B;AACF;AAAS,aAAO,KAAP;AALX;AAOD,CARD;;AAUA,sBAAsB,GAAtB,CAA0B,QAA1B,EAAoC;AAClC,aAAW,CAAC,GAAD,EAAM,GAAN,KAAc;AACvB,QAAI,EAAJ,GAAS,IAAI,GAAb;AACA,WAAO,IAAI,GAAX;AACA,WAAO,IAAI,GAAX;AACD;AALiC,CAApC;;kBASe,mBAAS,KAAT,CAAe,iBAAf,EAAkC,qBAAlC,C","file":"weather-criteria.js","sourcesContent":["import mongoose, { Schema } from 'mongoose';\r\n\r\nconst WeatherCriteriaSchema = new Schema({\r\n  user: {\r\n    type: Schema.Types.ObjectId,\r\n    ref: 'User',\r\n    required: true,\r\n    index: true,\r\n  },\r\n  city: {\r\n    type: Number,\r\n    ref: 'City',\r\n    required: true,\r\n    index: true,\r\n  },\r\n  temperature: {\r\n    type: Number,\r\n    required: true,\r\n  },\r\n  predicate: {\r\n    type: String,\r\n    enum: ['greater', 'less'],\r\n    default: 'greater',\r\n    required: true,\r\n  },\r\n  fulfilledAt: {\r\n    type: Date,\r\n  },\r\n  acknoweledgedAt: {\r\n    type: Date,\r\n  },\r\n}, {\r\n  // createdAt and updatedAt\r\n  timestamps: true,\r\n});\r\n\r\nWeatherCriteriaSchema.methods.isFulfilledWithTemperature = function (temperature) {\r\n  switch (this.predicate) {\r\n    case 'greater':\r\n      return temperature >= this.temperature;\r\n    case 'less':\r\n      return temperature <= this.temperature;\r\n    default: return false;\r\n  }\r\n};\r\n\r\nWeatherCriteriaSchema.set('toJSON', {\r\n  transform: (doc, ret) => {\r\n    ret.id = doc._id;\r\n    delete ret._id;\r\n    delete ret.__v;\r\n  },\r\n});\r\n\r\n\r\nexport default mongoose.model('WeatherCriteria', WeatherCriteriaSchema);\r\n"]}